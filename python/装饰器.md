# è£…é¥°å™¨çš„å®šä¹‰
åœ¨ä»£ç è¿è¡ŒæœŸé—´ï¼Œè¦å¢å¼ºå‡½æ•°çš„åŠŸèƒ½ï¼Œä½†æ˜¯åˆä¸å¸Œæœ›ä¿®æ”¹å‡½æ•°çš„å®šä¹‰ï¼Œè¿™ç§åœ¨ä»£ç è¿è¡ŒæœŸé—´åŠ¨æ€å¢åŠ åŠŸèƒ½çš„æ–¹å¼ï¼Œç§°ä¹‹ä¸º"è£…é¥°å™¨"(Decorator)

[è£…é¥°å™¨-å»–é›ªå³°å®˜ç½‘](https://www.liaoxuefeng.com/wiki/1016959663602400/1017451662295584)

# ä½¿ç”¨æ–¹æ³•
`decorator`ï¼Œæ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªå‡½æ•°ã€‚æˆ‘ä»¬è¦å€ŸåŠ©`Python`çš„`@`è¯­æ³•ï¼ŒæŠŠ`decorator`ç½®äºå‡½æ•°çš„å®šä¹‰å¤„ï¼š
~~~python
import time
import functools
def metric(text):
    def dec(func):
        @functools.wraps(func)
        def wapp(*args, **kwargs):
            f = time.time()
            fn = func(*args, **kwargs)
            l = time.time()
            print(func.__name__, text, l - f)
            return fn
        return wapp
    return dec
@metric('æ‰§è¡Œæ—¶é—´')
def fast(x, y):
    time.sleep(1)
    return x + y
f = fast
print(f(1, 2))
~~~
ç»“æœè¿”å›ï¼š
~~~python
fast æ‰§è¡Œæ—¶é—´ 1.000016212463379
3
fast
~~~
è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ `functools.wraps(func)`ã€‚
åœ¨æ²¡æœ‰åŠ ä¸Š `functools.wraps(func)` æ—¶ï¼Œ ç»“æœä¼šè¿”å›ï¼š
~~~python
fast æ‰§è¡Œæ—¶é—´ 1.0045192241668701
3
wapp
~~~
å¯ä»¥å‘ç°å‡½æ•°åå˜ä¸ºäº†è£…é¥°å™¨å‡½æ•°åï¼ŒåŸæ¥å‡½æ•°è‡ªèº«ä¿¡æ¯ä¸¢å¤±ï¼ğŸ˜±

è¿™æ ·åœ¨ä¸€äº›ç‰¹æ®Šæƒ…å†µæ‰§è¡Œå°±ä¼šå‡ºé”™ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©`Python`å†…ç½®çš„`functools.wraps()`ã€‚

# @property  è£…é¥°å™¨
Python æä¾›äº† property è£…é¥°å™¨ï¼Œè¢«è£…é¥°çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ã€å½“ä½œã€å±æ€§æ¥ç”¨ï¼Œçœ‹ä¸‹é¢çš„ä¾‹å­ï¼š
~~~python
class Exam(object):
    def __init__(self, score):
        self._score = score

    @property
    def score(self):
        return self._score

    @score.setter
    def score(self, val):
        if val < 0:
            self._score = 0
        elif val > 100:
            self._score = 100
        else:
            self._score = val

>>> e = Exam(60)
>>> e.score
60
>>> e.score = 90
>>> e.score
90
>>> e.score = 200
>>> e.score
100
~~~
åœ¨ä¸Šé¢ï¼Œæˆ‘ä»¬ç»™æ–¹æ³• **score** åŠ ä¸Šäº† **@property**ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥æŠŠ score å½“æˆä¸€ä¸ªå±æ€§æ¥ç”¨ï¼Œæ­¤æ—¶ï¼Œåˆä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„è£…é¥°å™¨ **score.setter**ï¼Œå®ƒå¯ä»¥æŠŠè¢«è£…é¥°çš„æ–¹æ³•å˜æˆå±æ€§æ¥èµ‹å€¼ã€‚
å¦å¤–ï¼Œæˆ‘ä»¬ä¹Ÿä¸ä¸€å®šè¦ä½¿ç”¨ score.setter è¿™ä¸ªè£…é¥°å™¨ï¼Œè¿™æ—¶ score å°±å˜æˆä¸€ä¸ªåªè¯»å±æ€§äº†ï¼š
~~~python
class Exam(object):
    def __init__(self, score):
        self._score = score

    @property
    def score(self):
        return self._score

>>> e = Exam(60)
>>> e.score
60
>>> e.score = 200  # score æ˜¯åªè¯»å±æ€§ï¼Œä¸èƒ½è®¾ç½®å€¼
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-676-b0515304f6e0> in <module>()
----> 1 e.score = 200

AttributeError: can't set attribute
~~~
*  **@property** æŠŠæ–¹æ³•ã€å˜æˆã€äº†å±æ€§ã€‚